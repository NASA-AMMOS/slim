"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9343],{6599:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>p,toc:()=>c});var i=n(7462),a=(n(7294),n(3905)),r=n(614);const l="repos:\n  - repo: local\n    hooks:\n      - id: grype-cve-scan\n        name: Grype Vulnerability Scan\n        description: Scans for dependency vulnerabilities. Fails if CRITICAL vulnerabilities detected.\n        entry: python -c \"import os; import subprocess; import sys; os.environ['GRYPE_DB_AUTO_UPDATE'] = 'false'; result=subprocess.run(['grype', 'dir:.', '--fail-on', 'critical'], capture_output=True); print(result.stdout.decode()); print('CRITICAL level vulnerabilities found. To address issues, run scan via `grype dir:.`, then `git add` followed by `git commit` your fix or ignore via `git commit --no-verify`') if result.returncode != 0 else print('No CRITICAL level vulnerabilities found.'); sys.exit(result.returncode)\"\n        language: system\n        verbose: true\n        stages: [pre-push]",o={},s="Container Vulnerability Scanning",p={unversionedId:"guides/software-lifecycle/security/container-vulnerability-scanning/README",id:"guides/software-lifecycle/security/container-vulnerability-scanning/README",title:"Container Vulnerability Scanning",description:"A guide to scanning containers and container repositories for security vulnerabilities both manually and automatically.",source:"@site/docs/guides/software-lifecycle/security/container-vulnerability-scanning/README.mdx",sourceDirName:"guides/software-lifecycle/security/container-vulnerability-scanning",slug:"/guides/software-lifecycle/security/container-vulnerability-scanning/",permalink:"/slim/docs/guides/software-lifecycle/security/container-vulnerability-scanning/",draft:!1,editUrl:"https://github.com/nasa-ammos/slim/tree/main/docs/guides/software-lifecycle/security/container-vulnerability-scanning/README.mdx",tags:[],version:"current",frontMatter:{},sidebar:"guidesSidebar",previous:{title:"Security",permalink:"/slim/docs/category/security"},next:{title:"GitHub Security Best Practices",permalink:"/slim/docs/guides/software-lifecycle/security/github-security/"}},u={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Step-by-Step Guide",id:"step-by-step-guide",level:2},{value:"Step 1: Scan Locally for Container Vulnerabilities",id:"step-1-scan-locally-for-container-vulnerabilities",level:3},{value:"Step 2: Setup Automated Local Scanning of Container Vulnerabilities",id:"step-2-setup-automated-local-scanning-of-container-vulnerabilities",level:3},{value:"Step 3: Set Up Automated Repository Scanning",id:"step-3-set-up-automated-repository-scanning",level:3},{value:"Frequently Asked Questions (FAQ)",id:"frequently-asked-questions-faq",level:2},{value:"Credits",id:"credits",level:2},{value:"Feedback and Contributions",id:"feedback-and-contributions",level:2}],m={toc:c},d="wrapper";function k(e){let{components:t,...o}=e;return(0,a.kt)(d,(0,i.Z)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"container-vulnerability-scanning"},"Container Vulnerability Scanning"),(0,a.kt)("pre",{align:"center"},"A guide to scanning containers and container repositories for security vulnerabilities both manually and automatically."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"banner-image",src:n(2160).Z,width:"1060",height:"368"})),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Background"),": To maintain the integrity and security of your containers in production environments, it's essential to monitor dependency vulnerabilities. Third-party software dependencies can harbor security vulnerabilities. This guide focuses on utilizing Grype, an open source vulnerability scanner, to proactively detect vulnerabilities in dependencies defined within container images as well as generally within repositories that use package managers."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Use Cases"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Scanning container images for vulnerabilities during the development phase"),(0,a.kt)("li",{parentName:"ul"},"Ensuring base container images are as vulnerability-free as possible"),(0,a.kt)("li",{parentName:"ul"},"Scanning package-manager defined software dependencies (e.g. NPM, YARN, Maven, etc.) for vulnerabilities during the development phase"),(0,a.kt)("li",{parentName:"ul"},"Automating vulnerability detection in repositories")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Software:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"OCI compliant containers (e.g. Docker, Podman) or other package-manager software dependencies"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"pre-commit")," framework")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Skills:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Basic knowledge of Git hooks and Docker commands"),(0,a.kt)("li",{parentName:"ul"},"Understanding of YAML for pre-commit configuration")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"quick-start"},"Quick Start"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Run a local scan of your container's repository (folder containing the Dockerfile) using ",(0,a.kt)("a",{parentName:"strong",href:"https://github.com/anchore/grype"},"Grype"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"grype dir:.\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Run a local scan of a Docker image using Grype")),(0,a.kt)("p",null,"First, build the Docker image:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker build -t my-app:latest .\n")),(0,a.kt)("p",null,"Then, scan the built Docker image:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"grype my-app:latest\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2b07\ufe0f ",(0,a.kt)("a",{parentName:"strong",href:"pathname:///assets/software-lifecycle/security/container-vulnerability-scanning/pre-commit-config.yml"},"Grype Scanning .pre-commit-config.yml"))),(0,a.kt)("p",null,"Download the file above to access the pre-commit configuration file, which includes an example hook for Grype vulnerability scanning. This file should be placed within your local Git repository after installing the pre-commit framework."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2b07\ufe0f ",(0,a.kt)("a",{parentName:"strong",href:"https://github.com/marketplace/actions/anchore-container-scan"},"Grype GitHub Action"))),(0,a.kt)("p",null,"GitHub Action for Grype vulnerability scanning. "),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"step-by-step-guide"},"Step-by-Step Guide"),(0,a.kt)("h3",{id:"step-1-scan-locally-for-container-vulnerabilities"},"Step 1: Scan Locally for Container Vulnerabilities"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Ensure Grype is installed on your system. You can install Grype from ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/anchore/grype"},"the official repository"),"."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"grype version\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Perform a scan of the local repository for vulnerabilities. The below checks for vulnerabilities via any common package managers that are detected in your repository. See ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/anchore/grype?tab=readme-ov-file#supported-sources"},"Grype supported sources")," for more information."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"grype dir:.\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"To scan a Docker image, first build the Docker image:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker build -t my-app:latest .\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Then, perform a scan of the built Docker image:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"grype my-app:latest\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"If you find vulnerabilities, fix them via your package manager. "))),(0,a.kt)("h3",{id:"step-2-setup-automated-local-scanning-of-container-vulnerabilities"},"Step 2: Setup Automated Local Scanning of Container Vulnerabilities"),(0,a.kt)("p",null,"\u26a0\ufe0f NOTE: We recommend installing this pre-commit hook only if you have downloaded grype, already scanned your repository and addressed any vulnerabilities."),(0,a.kt)("p",null,"\u26a0\ufe0f NOTE: The automated scan described below will NOT check for image vulnerabilities, rather, it uses the package dependency capability of Grype to look for third-party dependencies via ",(0,a.kt)("inlineCode",{parentName:"p"},"grype dir:.")),(0,a.kt)("p",null,"The below steps, once enacted, will ensure that any local ",(0,a.kt)("inlineCode",{parentName:"p"},"git push")," actions taken will be followed by an automated vulnerability scan. If vulnerabilities at the CRITICAL level are found, the push will be blocked by default."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Install the pre-commit framework via Python:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"pip install pre-commit\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a ",(0,a.kt)("inlineCode",{parentName:"p"},".pre-commit-config.yaml")," file in the root directory of your Git repository with the following content for Grype scanning:"),(0,a.kt)(r.Z,{language:"yaml",mdxType:"CodeBlock"},l)),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Initialize pre-commit in your repository with the new configuration:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"pre-commit install\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Grype-based vulnerability scanning should run every time a ",(0,a.kt)("inlineCode",{parentName:"p"},"git push")," is invoked. The push will be blocked if CRITICAL level vulnerabilities are found and will ask the developer to fix them prior to committing. Otherwise a report will be provided for reference. "))),(0,a.kt)("h3",{id:"step-3-set-up-automated-repository-scanning"},"Step 3: Set Up Automated Repository Scanning"),(0,a.kt)("p",null,"For GitHub users, we recommend:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Installing the official Grype GitHub action to set up automated dependency vulnerability scanning. The tool is available ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/marketplace/actions/anchore-container-scan"},"at this link"),"."),(0,a.kt)("li",{parentName:"ul"},"Setting up GitHub's official Dependabot action to also look for vulnerabilities. See our ",(0,a.kt)("a",{parentName:"li",href:"/docs/guides/software-lifecycle/security/github-security"},"GitHub Security Guide")," on this. ")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"frequently-asked-questions-faq"},"Frequently Asked Questions (FAQ)"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Q: What happens if the pre-commit scan finds vulnerabilities?")),(0,a.kt)("p",null,"A: The pre-commit hook will prevent you from committing changes until the vulnerabilities are resolved. The scan is set to alert only for ",(0,a.kt)("inlineCode",{parentName:"p"},"critical")," vulnerabilities by default to minimize disruption."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Q: What if I want to skip the pre-commit scan temporarily?")),(0,a.kt)("p",null,"A: You can bypass the hook by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"--no-verify")," flag with the ",(0,a.kt)("inlineCode",{parentName:"p"},"git commit")," command, though this is generally not recommended."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Q: Is it possible to run vulnerability scans without pre-commit hooks?")),(0,a.kt)("p",null,"A: Yes, you can incorporate scans into your CI/CD pipeline or utilize other repository scanning tools, which can prevent pushing vulnerable code."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Q: What's the difference between Grype and GitHub's Dependabot? Why do I need both?")),(0,a.kt)("p",null,"A: Grype relies on free and open software vulnerability databases whereas GitHub's Dependabot may be using proprietary methods. In our testing, we've found some non-overlapping vulnerabilities that are sometimes found in one tool but not the other."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"credits"},"Credits"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Authorship"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.github.com/riverma"},"Rishi Verma"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Acknowledgements"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"OPERA SDS Project for implementation guidance"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/ddalton-swe"},"@ddalton-swe")," for tool suggestions")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"feedback-and-contributions"},"Feedback and Contributions"),(0,a.kt)("p",null,"We welcome feedback and contributions to enhance this guide further. Please refer to our ",(0,a.kt)("a",{parentName:"p",href:"https://nasa-ammos.github.io/slim/docs/contribute/contributing/"},"contribution guidelines"),"."))}k.isMDXComponent=!0},2160:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/vulnerability-scanning-screen-57ff8ea9c83b29e0d64c26361906d042.png"}}]);