"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4103],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=a.createContext({}),c=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(o.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=i,h=u["".concat(o,".").concat(d)]||u[d]||m[d]||r;return n?a.createElement(h,s(s({ref:t},p),{},{components:n})):a.createElement(h,s({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,s=new Array(r);s[0]=d;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[u]="string"==typeof e?e:i,s[1]=l;for(var c=2;c<r;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6129:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var a=n(7462),i=(n(7294),n(3905));const r={},s="Secrets Detection",l={unversionedId:"guides/software-lifecycle/security/secrets-detection/README",id:"guides/software-lifecycle/security/secrets-detection/README",title:"Secrets Detection",description:"Guide to identify and automatically prevent leaking of sensitive information into your codebase.",source:"@site/docs/guides/software-lifecycle/security/secrets-detection/README.md",sourceDirName:"guides/software-lifecycle/security/secrets-detection",slug:"/guides/software-lifecycle/security/secrets-detection/",permalink:"/slim/docs/guides/software-lifecycle/security/secrets-detection/",draft:!1,editUrl:"https://github.com/nasa-ammos/slim/tree/main/docs/guides/software-lifecycle/security/secrets-detection/README.md",tags:[],version:"current",frontMatter:{},sidebar:"guidesSidebar",previous:{title:"GitHub Security Best Practices",permalink:"/slim/docs/guides/software-lifecycle/security/github-security/"},next:{title:"Continuous Integration",permalink:"/slim/docs/guides/software-lifecycle/continuous-integration/"}},o={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Step-by-Step Guide",id:"step-by-step-guide",level:2},{value:"Layer 1: Full Scan and Audit (Client-side)",id:"layer-1-full-scan-and-audit-client-side",level:3},{value:"Steps",id:"steps",level:4},{value:"Layer 2: Git Commit Scan (Client-side)",id:"layer-2-git-commit-scan-client-side",level:3},{value:"Steps",id:"steps-1",level:4},{value:"Layer 3: Server-side Push to GitHub.com",id:"layer-3-server-side-push-to-githubcom",level:3},{value:"Steps",id:"steps-2",level:4},{value:"Frequently Asked Questions (FAQ)",id:"frequently-asked-questions-faq",level:3},{value:"Credits",id:"credits",level:2},{value:"Feedback and Contributions",id:"feedback-and-contributions",level:2}],p={toc:c},u="wrapper";function m(e){let{components:t,...r}=e;return(0,i.kt)(u,(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"secrets-detection"},"Secrets Detection"),(0,i.kt)("pre",{align:"center"},"Guide to identify and automatically prevent leaking of sensitive information into your codebase."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"secrets-screenshot-example",src:n(8396).Z,width:"1062",height:"467"})),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Example secrets scanning rendering")),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Background"),": Sensitive information like API keys, passwords or tokens may be inadvertently committed to your repository. Such slip-ups can pose significant security risks. We recommend not only recurring scans for sensitive information, but proactively preventing sensitive information from getting infused. To support these goals, we recommend a tool called ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Yelp/detect-secrets"},"detect-secrets"),' that mitigates these risks. It scans for common sensitive information categories like passwords and other high-entropy values that contain sensitive data. It also provides a plugin system to support additional customization. It\'s fast for use in continuous integration pipelines and quickly executes on local-developer machines. It uses a "baseline file" approach, leveraging ',(0,i.kt)("inlineCode",{parentName:"p"},".secrets.baseline"),", that streamlines management of legitimate secrets and reduces false positives. This helps both new and established projects detect and prevent secrets from entering the code base."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use Cases"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Finding and preventing commits of sensitive information such as:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Username / passwords"),(0,i.kt)("li",{parentName:"ul"},"High entropy strings"),(0,i.kt)("li",{parentName:"ul"},"IP addresses"),(0,i.kt)("li",{parentName:"ul"},"E-mail addresses"),(0,i.kt)("li",{parentName:"ul"},"AWS sensitive information"))),(0,i.kt)("li",{parentName:"ul"},"Scanning local client repositories for exposed sensitive information ",(0,i.kt)("em",{parentName:"li"},"before")," making them public."),(0,i.kt)("li",{parentName:"ul"},"Preventing secrets from being committed to a local repository using pre-commit hooks."),(0,i.kt)("li",{parentName:"ul"},"Implementing a safety net in continuous integration (CI) pipelines using GitHub Actions to catch inadvertent secret commits."),(0,i.kt)("li",{parentName:"ul"},"Streamlining the management of known secrets and false positives during codebase audits.")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("p",null,"To get the most out of ",(0,i.kt)("inlineCode",{parentName:"p"},"detect-secrets"),", you'll need:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Python 3 with the ",(0,i.kt)("inlineCode",{parentName:"li"},"pip")," tool installed."),(0,i.kt)("li",{parentName:"ul"},"(Optional) Familiarity with Python for potential custom plugin development."),(0,i.kt)("li",{parentName:"ul"},"(Optional) A GitHub repository supporting GitHub Actions.")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"quick-start"},"Quick Start"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Install slim-detect-secrets:"),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"\u2139\ufe0f ",(0,i.kt)("strong",{parentName:"p"},"Note:")," the SLIM project has customized the Detect Secrets tool to identify additional sensitive keywords such as IP addresses, file paths, and AWS information. These additions are currently ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Yelp/detect-secrets/pulls/perryzjc"},"under review")," by the detect-secrets team for merge into the tool's ",(0,i.kt)("inlineCode",{parentName:"p"},"main")," codebase. Until then we recommend using our SLIM fork as described below. ")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pip install git+https://github.com/NASA-AMMOS/slim-detect-secrets.git@exp\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Execute a baseline scan:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"detect-secrets scan --all-files --disable-plugin AbsolutePathDetectorExperimental --exclude-files '\\.secrets.*' --exclude-files '\\.git*' > .secrets.baseline\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Review the ",(0,i.kt)("inlineCode",{parentName:"p"},".secrets.baseline")," file for any detected secrets via an audit:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"detect-secrets audit .secrets.baseline\n")))),(0,i.kt)("p",null,"Additional steps like whitelisting accepted values and false positives, establishing pre-commit hooks and/or enabling further automation are covered in detail below."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"step-by-step-guide"},"Step-by-Step Guide"),(0,i.kt)("p",null,"There are three recommended layers of protection we suggest you enable to ensure comprehensive security. Please see below sections for further details. "),(0,i.kt)("h3",{id:"layer-1-full-scan-and-audit-client-side"},"Layer 1: Full Scan and Audit (Client-side)"),(0,i.kt)("p",null,"This layer directly scans the developer's local environment using the ",(0,i.kt)("inlineCode",{parentName:"p"},"detect-secrets")," tool. After scanning, a baseline file containing detected secrets is generated. Developers can audit this file for detailed information on detected secrets."),(0,i.kt)("h4",{id:"steps"},"Steps"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Installation")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Install the experimental version of ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/NASA-AMMOS/slim-detect-secrets/tree/exp"},"slim-detect-secrets"),".",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pip install git+https://github.com/NASA-AMMOS/slim-detect-secrets.git@exp\n"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Scanning")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Scan all local files from the current directory and output results to a baseline file.",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"detect-secrets scan --all-files --disable-plugin AbsolutePathDetectorExperimental --exclude-files '\\.secrets.*' --exclude-files '\\.git*' > .secrets.baseline\n"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Checking Results")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"View the results in the baseline file.",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cat .secrets.baseline\n"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Analysis")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Analyze results using the ",(0,i.kt)("inlineCode",{parentName:"li"},"audit")," tool.",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"detect-secrets audit .secrets.baseline\n")))))),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/Yelp/detect-secrets#auditing-secrets-in-baseline"},"View more on Auditing Secrets in Baseline")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u2139\ufe0f ",(0,i.kt)("strong",{parentName:"p"},"Note"),": If you've marked any secrets as true positives, make sure to remove all references to these secrets and rerun a full scan.")),(0,i.kt)("h3",{id:"layer-2-git-commit-scan-client-side"},"Layer 2: Git Commit Scan (Client-side)"),(0,i.kt)("p",null,"This layer represents a prevention mechanism in the local developer environment that scans changes when a developer tries to commit and if new secrets are detected, the commit is blocked."),(0,i.kt)("p",null,"To support this strategy, we recommend the installation of another third party tool called ",(0,i.kt)("a",{parentName:"p",href:"https://pre-commit.com/#install"},"pre-commit"),", which is integral in allowing specialized plugins to run during the local developer's commit phase of using Git. It allows detect-secrets to prevent commits that are flagged with sensitive information."),(0,i.kt)("h4",{id:"steps-1"},"Steps"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Installation")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Install ",(0,i.kt)("a",{parentName:"p",href:"https://pre-commit.com/#install"},"pre-commit"),"."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pip install pre-commit\n"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Configuration")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Create a ",(0,i.kt)("inlineCode",{parentName:"p"},".pre-commit-config.yaml")," configuration file with the below contents."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"  repos:\n    - repo: https://github.com/NASA-AMMOS/slim-detect-secrets\n      # using commit id for now, will change to tag when official version is released\n      rev: 91e097ad4559ae6ab785c883dc5ed989202c7fbe\n      hooks:\n        - id: detect-secrets\n          args:\n            - '--baseline'\n            - '.secrets.baseline'\n            - '--exclude-files'\n            - '\\.git*'\n            - '--exclude-files'\n            - '\\.secrets.*' \n"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Hook Installation")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Install the pre-commit hook into your local environment, ensuring the hook gets invoked during local git commits."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pre-commit install\n"))))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Committing Changes")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Commit changes. If new secrets are detected, the commit will be blocked.")))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"  \u2139\ufe0f ",(0,i.kt)("strong",{parentName:"p"},"Note"),": The pre-commit hook does not automatically update the ",(0,i.kt)("inlineCode",{parentName:"p"},".secrets.baseline")," file. Update it by re-running the scan command.")),(0,i.kt)("h3",{id:"layer-3-server-side-push-to-githubcom"},"Layer 3: Server-side Push to GitHub.com"),(0,i.kt)("p",null,"This strategy provides a final layer of protection by scanning server-side commits for sensitive information during pull request creation. It leverages the ",(0,i.kt)("a",{parentName:"p",href:"https://pre-commit.com/#install"},"pre-commit")," tool and ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/features/actions"},"GitHub Action"),". The scan is triggered during a push or pull request and any detected new secrets are reported while blocking merges or pushes to protected branches."),(0,i.kt)("h4",{id:"steps-2"},"Steps"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Workflow Creation"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The first step is to create a ",(0,i.kt)("inlineCode",{parentName:"li"},"detect-secrets.yaml")," workflow file in the ",(0,i.kt)("inlineCode",{parentName:"li"},".github/workflows")," directory to define the GitHub action. Copy and paste the below while ensuring the correct branch of your codebase is referenced. For example (from the ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/NASA-AMMOS/slim-starterkit-python/blob/main/.github/workflows/secrets-detection.yml"},"Slim Python Starter Kit"),"):")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'name: "Secret Detection"\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    # The branches below must be a subset of the branches above\n    branches: [develop]\n\njobs:\n  secret-detection:\n    name: Secret-Detection\n    runs-on: ubuntu-latest\n    permissions:\n      actions: write\n      contents: read\n      security-events: write\n    steps:\n    - name: Checkout repository\n      uses: actions/checkout@v4\n      with:\n        fetch-depth: 0\n    - name: Upgrade tooling\n      run: |\n        python3 -m pip install --upgrade pip\n        pip install --upgrade git+https://github.com/NASA-AMMOS/slim-detect-secrets.git@exp\n        pip install --upgrade jq\n    - name: Create baseline config\n      run: |\n        if [ ! -f .secrets.baseline ] ; \n        then\n            # This generated baseline file will only be temporarily available on the GitHub side and will not appear in the user\'s local files.\n            # Scanning an empty folder to generate an initial .secrets.baseline without secrets in the results.\n            echo "\u26a0\ufe0f No existing .secrets.baseline file detected. Creating a new blank baseline file."\n            mkdir empty-dir\n            detect-secrets scan empty-dir > .secrets.baseline\n            echo "\u2705 Blank .secrets.baseline file created successfully."\n            rm -r empty-dir\n        else\n            echo "\u2705 Existing .secrets.baseline file detected. No new baseline file will be created."\n        fi\n    - name: Scan\n      run: |\n        # scripts scan repository for new secrets\n        # backup list of known secrets\n        cp -pr .secrets.baseline .secrets.new\n        # find secrets in the repository\n        detect-secrets scan --disable-plugin AbsolutePathDetectorExperimental --baseline .secrets.new \\\n            --exclude-files \'\\.secrets..*\' \\\n            --exclude-files \'\\.git.*\' \\\n            --exclude-files \'\\.mypy_cache\' \\\n            --exclude-files \'\\.pytest_cache\' \\\n            --exclude-files \'\\.tox\' \\\n            --exclude-files \'\\.venv\' \\\n            --exclude-files \'venv\' \\\n            --exclude-files \'dist\' \\\n            --exclude-files \'build\' \\\n            --exclude-files \'.*\\.egg-info\'\n        # break build when new secrets discovered\n        # function compares baseline/new secrets w/o listing results -- success(0) when new secret found\n        compare_secrets() { diff <(jq -r \'.results | keys[] as $key | "\\($key),\\(.[$key] | .[] | .hashed_secret)"\' "${1}" | sort) <(jq -r \'.results | keys[] as $key | "\\($key),\\(.[$key] | .[] | .hashed_secret)"\' "${2}" | sort) | grep -q \'>\' ; }\n        # test baseline versus new secret files\n        if compare_secrets .secrets.baseline .secrets.new; \n        then\n            echo "\u26a0\ufe0f Attention Required! \u26a0\ufe0f" >&2\n            echo "New secrets have been detected in your recent commit. Due to security concerns, we cannot display detailed information here and we cannot proceed until this issue is resolved." >&2\n            echo "" >&2\n            echo "Please follow the steps below on your local machine to reveal and handle the secrets:" >&2\n            echo "" >&2\n            echo "1\ufe0f\u20e3 Run the \'detect-secrets\' tool on your local machine. This tool will identify and clean up the secrets. You can find detailed instructions at this link: https://nasa-ammos.github.io/slim/continuous-testing/starter-kits/#detect-secrets" >&2\n            echo "" >&2\n            echo "2\ufe0f\u20e3 After cleaning up the secrets, commit your changes and re-push your update to the repository." >&2\n            echo "" >&2\n            echo "Your efforts to maintain the security of our codebase are greatly appreciated!" >&2\n            exit 1\n        else\n            echo "\ud83d\udfe2 Secrets tests PASSED! \ud83d\udfe2" >&1\n            echo "No new secrets were detected in comparison to any baseline configurations."  >&1\n            exit 0\n        fi \n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," > \u2139\ufe0f  Explanation: The GitHub Action checks out code, installs necessary packages, checks for a baseline file, and scans the repository for secrets. If new secrets are detected, the build fails and provides guidance.\n")),(0,i.kt)("p",null,"After setting this up, GitHub will run the workflow during pushes or pull requests. If any new secrets are detected, the status check will fail and the user will be notified in the pull request."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u26a0\ufe0f Warning: The check ensures specific lines of code that may contain sensitive information are not disclosed publicly. In GitHub Action logs only a yes/no indication of sensitive information appears. However, the surface area exists for potential attackers to readily identify sensitive information. Monitor your pull requests actively to respond and always ensure your team actively uses ",(0,i.kt)("a",{parentName:"p",href:"#layer-1-full-scan-and-audit-client-side"},"Layer 1")," and ",(0,i.kt)("a",{parentName:"p",href:"#layer-2-git-commit-scan-client-side"},"Layer 2")," to mitigate issues in the first place.  ")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"frequently-asked-questions-faq"},"Frequently Asked Questions (FAQ)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Q: ",(0,i.kt)("strong",{parentName:"p"},"If secrets are detected in my code, what should I do?")),(0,i.kt)("p",{parentName:"li"},"A: Follow these steps:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Identify and Confirm:")," Review the identified secrets in the ",(0,i.kt)("inlineCode",{parentName:"li"},".secrets.baseline")," or any other report generated. Ensure that they are indeed secrets and not false positives."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Removal:")," Remove or replace all references to the detected secrets from your codebase. Ensure that no trace of the secret remains in the code, comments, or commit history. If you want to ignore the secret as a false positive during a pre-commit scan, you can follow directions ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/Yelp/detect-secrets#inline-allowlisting-1"},"here"),". "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Rotation:")," If the detected secret was an API key, password, or any other form of authentication, consider it compromised. Rotate the secret immediately, i.e., generate a new secret/key and update it wherever required."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Rerun Scans:")," After you've made the necessary changes, run the ",(0,i.kt)("inlineCode",{parentName:"li"},"detect-secrets")," tool again to ensure no secrets remain."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Commit Safely:")," When you're sure all secrets have been removed, you can safely commit your changes. Remember, the Git commit scan (Layer 2) and the server-side push scan (Layer 3) will provide additional layers of checks."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Educate and Prevent:")," To avoid such instances in the future, educate your team on the importance of not committing secrets and the potential risks associated with it. Consider adopting practices or tools that prevent the accidental inclusion of secrets in your codebase."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Q: ",(0,i.kt)("strong",{parentName:"p"},"Does detect-secrets scan the entire Git history?")),(0,i.kt)("p",{parentName:"li"},"A: No, it's designed to scan the current state of a project for efficiency.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Q: ",(0,i.kt)("strong",{parentName:"p"},"How are commits containing secrets removed permanently from Git history?")),(0,i.kt)("p",{parentName:"li"},"A: The process of scrubbing errant commits and their content involves a destructive rewrite of repository commit history. Backups are essential and changes must be handled with precision and caution. One solution is to start a new repository from scratch with only the latest cleaned code, thereby negating the need to change existing repository content. Solutions involving more entropy include Git filter commands or well-known cleaning applications, such as ",(0,i.kt)("a",{parentName:"p",href:"https://rtyley.github.io/bfg-repo-cleaner/"},"BFG Repo-Cleaner"),". Because of the risks involved in mutating repository history and content, such changes ",(0,i.kt)("em",{parentName:"p"},"always")," must be handled with backups, expertise and extreme care.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Q: ",(0,i.kt)("strong",{parentName:"p"},"Where can I find more configurations and options for detect-secrets?")),(0,i.kt)("p",{parentName:"li"},"A: Refer to the official documentation for ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Yelp/detect-secrets"},"detect-secrets")," and ",(0,i.kt)("a",{parentName:"p",href:"https://pre-commit.com/"},"pre-commit"),"."))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"credits"},"Credits"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Authorship"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Jingchao Zhong ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/perryzjc"},"@perryzjc")),(0,i.kt)("li",{parentName:"ul"},"Rishi Verma ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/riverma"},"@riverma")),(0,i.kt)("li",{parentName:"ul"},"John Engelke ",(0,i.kt)("a",{parentName:"li",href:"http://github.com/jpl-jengelke"},"@jpl-jengelke"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Acknowledgements"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Yelp/detect-secrets"},"Yelp's detect-secrets maintainers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/nutjob4life"},"@nutjob4life")," for detect-secrets usage tips")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"feedback-and-contributions"},"Feedback and Contributions"),(0,i.kt)("p",null,"We value your feedback and contributions. Enhance and expand this guide by referring to our ",(0,i.kt)("a",{parentName:"p",href:"https://nasa-ammos.github.io/slim/docs/contribute/contributing/"},"contribution guidelines"),"."))}m.isMDXComponent=!0},8396:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/secrets-screen-213f4b67a98901197fb279a595129ddb.png"}}]);